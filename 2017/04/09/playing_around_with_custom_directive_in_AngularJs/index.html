<!DOCTYPE html><html lang="English"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title>Playing around custom directive in AngularJs · CodexDelta</title><meta name="description" content="Playing around custom directive in AngularJs - Aswin Devarajan"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials-theme-minima.css"><link rel="search" type="application/opensearchdescription+xml" href="http://codexdelta.github.io/atom.xml" title="CodexDelta"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://www.linkedin.com/in/aswindevarajan/" target="_blank" class="nav-list-link">ABOUT ME</a></li><li class="nav-list-item"><a href="https://github.com/codexdelta" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">Playing around custom directive in AngularJs</h1><div class="post-info">Apr 9, 2017</div><div class="post-content"><p>Directive is one of the most powerful feature of the angularjs but it is also one of the most confusing element of angularjs. In your template there would be so many repetitive components which would make our code bulky if we go forward by repeating the same code again and again so how about creating a custom directive which helps you repeat the component innumberable times with using ng-repeat irrespective of the position and template for the directive.<br><a id="more"></a></p>
<p>so how to use a directive, it could be used as an element, an attribute to another element, or even as a comment. Each directive could be restricted to the type of use using restrict key with value as ‘A’, ‘E’, ‘M’ or even ‘AEM’ or ‘AE’  or ‘EM’.</p>
<p>A: Attribute</p>
<p>E: Element</p>
<p>M: Comments</p>
<p>following code makes the attribute to be used as an attribute and as a element.</p>
<h5 id="Creating-a-simplest-custom-directive"><a href="#Creating-a-simplest-custom-directive" class="headerlink" title="Creating a simplest custom directive"></a>Creating a simplest custom directive</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">var app = angular.module(&apos;myApp&apos;, []);</div><div class="line">app.directive(&apos;interestCard&apos;, function()&#123;</div><div class="line">  return &#123;</div><div class="line">    restrict: &apos;AE&apos;, // restrict the use of directive as element or attribute to an element</div><div class="line">   	template: &apos;&lt;h1&gt;viva la vida&lt;/h1&gt;&apos;</div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>In the above directive we used template for defining how our directive would look like, we could add ‘replace: true,’ which will make sure that when our directive is called upon it actually replaces our directive with the template in directive thus you wont find the directive in final dom elements but you will find the template itself.</p>
<p>The template mentioned in above code is quite simple, it could be replaced by templareUrl to include a more complex template for the directive’s use.</p>
<p><strong>Understanding scope in directive</strong></p>
<p>Ever wondered what all options are available for angular to manipulate data at multiple levels in a single app. Manage data at main app controller, go with the modular approach in building app and handle separate isolated data model for making the isolated components work. In certain uses cases angular directive needs to interact with other controllers defined outside the directive to access certain functions and to change certain scope values. The directive could have its own controller or it can borrow it from main controller.</p>
<p>In the following section we will explore what all options we have in dealing with data and scoped objects at directive level. Scope in directive are of three types which includes: shared, inherited and isolated scopes. now what does it mean?</p>
<p>scope: false</p>
<p>Shared scope, when directive is using scope of controller. Normally scope in directive is always inherited by parent scope, thus making it accessable to functions and scope values defined in controller. Let me remind you any change in the directive in scope it will reflect in the controller’s scope.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">app.directive(&apos;vivaLaVida&apos;, function() &#123;</div><div class="line">  return &#123;</div><div class="line">    restrict: &apos;A&apos;,</div><div class="line">    scope: false,</div><div class="line">    ......</div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>scope: true</p>
<p>Then there is a true condition where a new scope is created for the directive and change in directive scope will not reflect in the scope of controller this new scope is a disconnected child of the parent controller with all the same property but no tie with the parent.</p>
<p>scope: {}</p>
<p>when scope(directive) is completely isolated from scope of controller we go with ‘scope: {}’. well why isolated scope what’s the need to have a sperate scope when you already have one which can be accessed by all. the point to drive back home is you dont want your main controllers scope gets all messed up with logics which are specific to directives and would not be used anywhere else other then that directive.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">app.directive(&apos;vivaLaVida&apos;, function()&#123;</div><div class="line">  return&#123;</div><div class="line">    restrict: &apos;AE&apos;,</div><div class="line">    scope: &#123;&#125;</div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>scope elements could be made to connect with different elements through different binding levels, this makes isolated scope great since you have the enviornment totally isolated plus connectivity required as per need. this binding involves</p>
<ul>
<li>@ : one way binding mostly used for passing strings values in scope</li>
<li>= : two way binding for sharing model. the model in parent scope is connected to isolated scope of directive.</li>
<li>&amp; : binding is for passing methods into isolated scope of directive making it available to be called form inside of directive.</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">app.directive(&apos;vivaLaVida&apos;, function()&#123;</div><div class="line">  return &#123;</div><div class="line">    restrict: &apos;AE&apos;,</div><div class="line">    scope: &#123;</div><div class="line">      messageText: &apos;@&apos;,</div><div class="line">      userModel: &apos;=&apos;,</div><div class="line">      alertFunction: &apos;&amp;&apos;</div><div class="line">    &#125;,</div><div class="line">    .....</div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h5 id="Compile-your-directive"><a href="#Compile-your-directive" class="headerlink" title="Compile your directive"></a>Compile your directive</h5><p>compile function is like adding last end changes and functionality before the directive is pushed to DOm with its controller. you can have both compile and link function  or inside link function you can have pre-link and post-link functions. its just the same.</p>
<p>now lets go deeper, lets bring some facts on the table regarding DOM and angular. If we go through what’s happening at the back then you would notice that at first whole of the DOM is loaded and then a broadcast is triggered when DOM is ready, angular listen to this trigger and parse the DOM searching for attribute ng-app when found it starts proccessing the DOM from that element.</p>
<p>Now its depends a lot on the directive’s defination for how angular would parse the directive. Following example would be helpful in understanding deeper concepts with compile and link functions.</p>
<p>following code reference from <a href="http://www.jvandemo.com/the-nitty-gritty-of-compile-and-link-functions-inside-angularjs-directives/" target="_blank" rel="external">jvandemo.com</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&lt;level-one&gt;  </div><div class="line">    &lt;level-two&gt;</div><div class="line">        &lt;level-three&gt;</div><div class="line">            Hello &#123;&#123;name&#125;&#125;         </div><div class="line">        &lt;/level-three&gt;</div><div class="line">    &lt;/level-two&gt;</div><div class="line">&lt;/level-one&gt;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">var app = angular.module(&apos;plunker&apos;, []);</div><div class="line"></div><div class="line">function createDirective(name)&#123;  </div><div class="line">  return function()&#123;</div><div class="line">    return &#123;</div><div class="line">      restrict: &apos;E&apos;,</div><div class="line">      compile: function(tElem, tAttrs)&#123;</div><div class="line">        console.log(name + &apos;: compile&apos;);</div><div class="line">        return &#123;</div><div class="line">          pre: function(scope, iElem, iAttrs)&#123;</div><div class="line">            console.log(name + &apos;: pre link&apos;);</div><div class="line">          &#125;,</div><div class="line">          post: function(scope, iElem, iAttrs)&#123;</div><div class="line">            console.log(name + &apos;: post link&apos;);</div><div class="line">          &#125;</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">app.directive(&apos;levelOne&apos;, createDirective(&apos;levelOne&apos;));  </div><div class="line">app.directive(&apos;levelTwo&apos;, createDirective(&apos;levelTwo&apos;));  </div><div class="line">app.directive(&apos;levelThree&apos;, createDirective(&apos;levelThree&apos;));</div></pre></td></tr></table></figure>
<p>here is the output</p>
<p><img src="http://www.jvandemo.com/content/images/2014/Aug/console-output-1.png" alt="Output"></p>
<p>if you notice the output console you would see the order in which the code runs.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// COMPILE PHASE</span></div><div class="line"><span class="comment">// levelOne:    compile function is called</span></div><div class="line"><span class="comment">// levelTwo:    compile function is called</span></div><div class="line"><span class="comment">// levelThree:  compile function is called</span></div><div class="line"></div><div class="line"><span class="comment">// PRE-LINK PHASE</span></div><div class="line"><span class="comment">// levelOne:    pre link function is called</span></div><div class="line"><span class="comment">// levelTwo:    pre link function is called</span></div><div class="line"><span class="comment">// levelThree:  pre link function is called</span></div><div class="line"></div><div class="line"><span class="comment">// POST-LINK PHASE (Notice the reverse order)</span></div><div class="line"><span class="comment">// levelThree:  post link function is called</span></div><div class="line"><span class="comment">// levelTwo:    post link function is called</span></div><div class="line"><span class="comment">// levelOne:    post link function is called</span></div></pre></td></tr></table></figure>
<p>few points to notice, how angular run the compile of each element from top to bottom and then run the link function starting with pre-link in the same order but the post-link function is reverse order.</p>
<p>Compile function:</p>
<p>use compile function to change the original DOM elements before angualrjs creates instance of it and before scope is created. ng-repeat is a perfect example for this.</p>
<p>When compile runs scope is yet not assigned hence compile function can be defined as</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line">* Compile function</div><div class="line">*</div><div class="line">* @param tElem - template element</div><div class="line">* @param tAttrs - attributes of the template element</div><div class="line">*/</div><div class="line"><span class="function"><span class="keyword">function</span>(<span class="params">tElem, tAttrs</span>)</span>&#123;</div><div class="line"></div><div class="line">    <span class="comment">// ...</span></div><div class="line"></div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>pre-link function:</p>
<p>use pre-link function to manipulate the scope of the directive before the post-link function is called since we have the scope, elements and attributes but no controller. Controller only comes in the post-link function of the directive.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line">* Pre-link function</div><div class="line">*</div><div class="line">* @param scope - scope assigned to the directive</div><div class="line">* @param tElem - template element</div><div class="line">* @param tAttrs - attributes of the template element</div><div class="line">*/</div><div class="line"><span class="function"><span class="keyword">function</span>(<span class="params">scope, tElem, tAttrs</span>)</span>&#123;</div><div class="line"></div><div class="line">    <span class="comment">// ...</span></div><div class="line"></div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>post-link function:</p>
<p>run post-link function to execute the logic of your directive or instance since all child elements compile and pre-link functions have been executed.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">/**</div><div class="line">* Post-link function</div><div class="line">*</div><div class="line">* @param scope - scope assigned to the directive</div><div class="line">* @param tElem - template element</div><div class="line">* @param tAttrs - attributes of the template element</div><div class="line">*/</div><div class="line">function(scope, tElem, tAttrs)&#123;</div><div class="line"></div><div class="line">    // ...</div><div class="line"></div><div class="line">&#125;;</div></pre></td></tr></table></figure>
</div></article></div></main><footer><div class="paginator"><a href="/2017/02/06/Building_production_ready_backend_in_20_mins/" class="prev">PREV</a><a href="/2017/05/02/transclusion_in_angularjs/" class="next">NEXT</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'aswindevarajan';
var disqus_identifier = '2017/04/09/playing_around_with_custom_directive_in_AngularJs/';
var disqus_title = 'Playing around custom directive in AngularJs';
var disqus_url = 'http://codexdelta.github.io/2017/04/09/playing_around_with_custom_directive_in_AngularJs/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//aswindevarajan.disqus.com/count.js" async></script><div class="copyright"><p>© 2017 - 2018 <a href="http://codexdelta.github.io">Aswin Devarajan</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script rel="text/javascript" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.min.js"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-113154557-1",'auto');ga('send','pageview');</script></body></html>